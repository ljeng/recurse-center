source('import.r')
source('functions.r')
factorList = list(c(168, 213, 47680, 51537, 63164, 83672, 85835, 9678), c(315, 9678, 12428, 16800, 17991, 19221, 21093, 49184, 51537, 52771, 59013, 81049, 85440), c(328, 1447, 1640, 7295, 12637, 18386, 18776, 19885, 21792, 39226, 43297, 47589, 49267, 54769, 59457, 61428, 63164, 79220, 81049), c(92, 262, 293, 31350, 8632, 18789, 18968, 29652, 35399, 40038, 51998, 68746, 81223), c(167, 328, 18882, 20068, 29214, 41048, 47649, 47752, 49775, 59972, 85340, 85598), c(115, 198, 579, 997, 12428, 15695, 16800, 17991, 26800, 28685, 37873, 46485, 47680, 63164, 83672, 85835, 85954, 86761), c(155, 156, 315, 14884, 15698, 19481, 31920, 51537, 64239, 85440, 85686), c(391, 19365, 52682, 75870, 95239, 6111, 9693, 14663, 17052, 18935, 22125, 26525, 70095), c(144, 333, 7248, 7920, 9662, 9688, 13077, 18048, 19221, 49267, 52884, 59456, 61465))
factorUnlist = unlist(factorList)
for (i in 1:length(factorUnlist)) {
	phiDf = matrix(nrow = 0, ncol = 3)
	for (j in c(2:1460, 1540:2621)) {
		qj = substring(colnames(userData)[j], 2)
		phiDf = rbind(phiDf, c(qj, max(abs(corMatrix(userData, qj, factorUnlist[i]))), toString(questionData[grep(paste0('q', qj, '$'), questionData[,1]), 2])))
	}
	print(phiDf[order(as.numeric(phiDf[,2]), na.last = TRUE, decreasing = TRUE),])
}
